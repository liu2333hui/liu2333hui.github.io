System.register("chunks:///_virtual/common.ts",["cc"],(function(f){"use strict";var n;return{setters:[function(f){n=f.cclegacy}],execute:function(){f({randInt:function(f,n){return Math.floor(Math.random()*(n-f))+f},sum_arr:function(f){return f.reduce((function(f,n){return f+n}),0)},syncArr:function(f,n){for(var t=0;t<f.length;t++)n[t]=f[t]},syncMap:function(f,n){f.forEach((function(f,t){n[t]=f}))}}),n._RF.push({},"ad0777KkUxG/52Z5WDRutEW","common",void 0);f("net2colors",{0:"#ff0000",1:"#ffff00",2:"#ff00ff",3:"#00ff00",4:"#fff000",5:"#ff0f00",6:"#ff00f0",7:"#ff000f",8:"#fff0f0",9:"#ff00ff",10:"#f0f0f0",11:"#660660",12:"#f60606",13:"#6f6006",14:"#ff0066",15:"#ff0060",16:"#ff0600",17:"#f60000",18:"#ff7070",19:"#ff7007",20:"#ff0770",21:"#770000",22:"#ff7000",23:"#ff0700",24:"#ff0070",25:"#ff0007",26:"#8f0800",27:"#ff0080",28:"#ff8000",29:"#8f0000",30:"#ff8080",31:"#000000",32:"#000000",33:"#000000",34:"#000000",35:"#000000",36:"#000000",37:"#000000",38:"#000000",39:"#000000"});n._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./MainGUI.ts","./Parser.ts","./PlaceGUI.ts","./Placer.ts","./Solver.ts","./common.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MainGUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Parser.ts","./Placer.ts","./Solver.ts"],(function(t){"use strict";var e,s,i,a,n,o,r,l,c,p,h,u,S;return{setters:[function(t){e=t.applyDecoratedDescriptor,s=t.inheritsLoose,i=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){n=t.cclegacy,o=t._decorator,r=t.Node,l=t.Label,c=t.resources,p=t.Component},function(t){h=t.parse},function(t){u=t.initialize_placement},function(t){S=t.Solver}],execute:function(){var N,d,v,T,I,L,f,E,g;n._RF.push({},"59370M7FjhG7aoBij8HWD2j","MainGUI",void 0);var _,m=o.ccclass,D=o.property;!function(t){t[t.ANNEALING=0]="ANNEALING",t[t.NETLIST_LOADED=1]="NETLIST_LOADED",t[t.NO_NETLIST=2]="NO_NETLIST"}(_||(_={}));t("MainGUI",(N=m("MainGUI"),d=D(r),v=D(r),T=D(r),N((f=e((L=function(t){function e(){for(var e,s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return e=t.call.apply(t,[this].concat(n))||this,i(e,"graphics",f,a(e)),i(e,"costLabel",E,a(e)),i(e,"netlistLabel",g,a(e)),e.state=_.NO_NETLIST,e.placeSolver=void 0,e}s(e,t);var n=e.prototype;return n.start=function(){this.startT=38,this.beta=.9,this.stop=92,this.cosineP=3,this.KFactor=1.79},n.processNetlist=function(t){var e=u(t);this.placeSolver=new S,this.placeSolver.setPlacement(e),this.placeSolver.setNetlistInfo(t),this.placeSolver.setParameters(this.startT,this.beta,this.stop,this.cosineP,this.KFactor),this.placeSolver.reset(),this.netlistLabel.getComponent(l).string=this.netlistName,this.updateGUI(),this.state=_.NETLIST_LOADED},n.updateGUI=function(){this.graphics.getComponent("PlaceGUI").drawPlacement(this.placeSolver.placement,this.placeSolver.netlist_info),this.costLabel.getComponent(l).string="Iteration: "+this.placeSolver.次+"\nCost: "+this.placeSolver.prev_cost+" \nTemp: "+this.placeSolver.T.toFixed(10)},n.swapHandler=function(){this.state!=_.NO_NETLIST&&(this.placeSolver.swapOnce(),this.updateGUI(),this.state=_.NETLIST_LOADED)},n.swapRoundHandler=function(){this.state!=_.NO_NETLIST&&(this.placeSolver.swapRound(),this.updateGUI(),this.state=_.NETLIST_LOADED)},n.resetHandler=function(){if(this.state!=_.NO_NETLIST){var t=u(this.placeSolver.netlist_info);this.placeSolver.setPlacement(t),this.placeSolver.reset(),this.updateGUI(),this.state=_.NETLIST_LOADED}},n.annealHandler=function(){this.state!=_.NO_NETLIST&&(this.state==_.ANNEALING?(this.placeSolver.不动次=0,this.state=_.NETLIST_LOADED):(this.placeSolver.不动次=0,this.state=_.ANNEALING))},n.update=function(t){this.state==_.ANNEALING&&(this.placeSolver.不动次>this.placeSolver.stopCount?this.state=_.NETLIST_LOADED:(this.placeSolver.swapRound(),this.updateGUI()))},n.loadCustomNetlist=function(t,e){var s=h(e);this.processNetlist(s)},n.loadNetlist=function(t,e){var s=this;this.netlistName=e,c.load(e,(function(t,e){console.log(e.text,e._name);var i=h(e.text,e._name);s.processNetlist(i)}))},n.startTSlider=function(t,e){var s=280*t.progress+20;t.node.children[1].getComponent(l).string="StartTemp: "+s.toFixed(2),this.startT=s,this.state!=_.NO_NETLIST&&(this.placeSolver.startT=s,this.placeSolver.reset(),this.updateGUI())},n.betaDecaySlider=function(t){var e=t.progress*(.99-.8)+.8;t.node.children[1].getComponent(l).string="BetaDecay: "+e.toFixed(2),this.beta=e,this.state!=_.NO_NETLIST&&(this.placeSolver.betaDecay=e,this.placeSolver.reset(),this.updateGUI())},n.stopCountSlider=function(t){var e=parseInt(195*t.progress+5);this.stop=e,t.node.children[1].getComponent(l).string="StopCount: "+e,this.state!=_.NO_NETLIST&&(this.placeSolver.stopCount=e,this.placeSolver.reset(),this.updateGUI())},n.cosineAnnealPeriodSlider=function(t){var e=parseInt(20*t.progress);t.node.children[1].getComponent(l).string="CosPeriod: "+e,this.cosineP=e,this.state!=_.NO_NETLIST&&(this.placeSolver.cosineAnnealPeriod=e,this.placeSolver.reset(),this.updateGUI())},n.KFactorSlider=function(t){var e=9.5*t.progress+.5;t.node.children[1].getComponent(l).string="KFactor: "+e.toFixed(2),this.KFactor=e,this.state!=_.NO_NETLIST&&(this.placeSolver.KFactor=e,this.placeSolver.reset(),this.updateGUI())},n.paretoSlider=function(){this.state,_.NO_NETLIST},e}(p)).prototype,"graphics",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(L.prototype,"costLabel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=e(L.prototype,"netlistLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=L))||I));n._RF.pop()}}}));

System.register("chunks:///_virtual/Parser.ts",["cc"],(function(t){"use strict";var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){t("parse",(function(t,e){for(var r=t.split("\n"),s=r[0].trim().split(" "),n=parseInt(s[0]),a=parseInt(s[1]),p=parseInt(s[2]),u=parseInt(s[3]),c=[],i=new Map,o=[],h=0,l=1;l<r.length;l++){var v=r[l].trim().split(" ");if(v.length>1){for(var f=parseInt(v[0]),g=[],I=1;I<v.length;I++)g.push(parseInt(v[I]));c.push(g),o.push(f);for(var _=0;_<g.length;_++){var b=g[_];i.has(b)?i.get(b).push(h):i.set(b,[h])}h+=1}}return{block_counts:n,net_counts:a,"行":p,"列":u,nets:c,block2net:i,pin_counts:o}})),e._RF.push({},"0903bbvsPpIaraiMeuueVL2","Parser",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/PlaceGUI.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){"use strict";var t,e,n,r,i,l;return{setters:[function(o){t=o.inheritsLoose},function(o){e=o.cclegacy,n=o._decorator,r=o.Vec3,i=o.Graphics,l=o.Component}],execute:function(){var s;e._RF.push({},"468431gxpRN15ICXVwRxVCL","PlaceGUI",void 0);var a=n.ccclass;n.property,o("PlaceGUI",a("PlaceGUI")(s=function(o){function e(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=o.call.apply(o,[this].concat(n))||this).W=void 0,t.H=void 0,t.行=void 0,t.列=void 0,t.x_margin=void 0,t.y_margin=void 0,t}t(e,o);var n=e.prototype;return n.onLoad=function(){},n.onDestroy=function(){},n.onTouchMove=function(o){new r(o.getDeltaX(),o.getDeltaY(),0)},n.onTouchStart=function(o){var t=this.W,e=this.H,n=this.行,r=this.y_margin,l=this.x_margin,s=this.列,a=parseInt((o.getLocation().y-300+n*e-this.y_margin)/(2*this.H)),c=parseInt((o.getLocation().x-320+s*t/2-this.x_margin)/this.W);console.log(c,a),console.log(o.getLocation());var f=c*t-s*t/2+l,h=2*a*e-n*e+r,v=this.getComponent(i);v.lineWidth=2,v.fillColor.fromHEX("#aa0000"),v.rect(f,h,t,e),v.stroke(),v.fill()},n.start=function(){var o=this.getComponent(i);o.lineWidth=10,o.fillColor.fromHEX("#ff0000"),o.moveTo(-40,0),o.lineTo(0,-80),o.lineTo(40,0),o.lineTo(0,80),o.close(),o.stroke(),o.fill(),o.clear(),o.lineWidth=10,o.fillColor.fromHEX("#ffffff"),o.moveTo(-320,0),o.lineTo(-320,-310),o.lineTo(330,-310),o.lineTo(320,310),o.lineTo(-320,310),o.close(),o.stroke(),o.fill()},n.update=function(o){},n.drawPlacement=function(o,t){t.block_counts,t.net_counts;var e=t.行,n=t.列,r=t.nets,l=(t.block2net,t.pin_counts,o.布局),s=this.getComponent(i);s.clear(),s.lineWidth=2,s.fillColor.fromHEX("#ff0000");var a=600/(n+1),c=600/(2*(e+1)),f=c/2;this.W=a,this.H=c,this.行=e,this.y_margin=f,this.x_margin=0,this.列=n,s.strokeColor.fromHEX("#000000");for(var h=0;h<e;h++)for(var v=0;v<n;v++){var u=v*a-n*a/2+0,g=2*h*c-e*c+f;s.rect(u,g,a,c),s.stroke()}for(var m=0;m<l.length;m++){var p=l[m],T=p%n*a-n*a/2+0,d=2*parseInt(p/n)*c-e*c+f;s.rect(T,d,a,c),s.stroke(),s.fill()}for(var _=0;_<r.length;_++){var k=r[_],y=l[k[0]],C=y%n*a-n*a/2+0,H=2*parseInt(y/n)*c-e*c+f;s.strokeColor.fromHEX("#000000");for(var I=1;I<k.length;I++){var x=l[k[I]],W=x%n*a-n*a/2+0,X=2*parseInt(x/n)*c-e*c+f;s.moveTo(C+a/2,H+c/2),s.lineTo(W+a/2,X+c/2),s.stroke()}}s.moveTo(-320,0),s.lineTo(-320,-310),s.lineTo(320,-310),s.lineTo(320,310),s.lineTo(-320,310),s.close(),s.stroke()},e}(l))||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/Placer.ts",["cc"],(function(t){"use strict";var n;return{setters:[function(t){n=t.cclegacy}],execute:function(){t({absolute_cost:function(t,n,a){void 0===a&&(a=2);n.block_counts,n.net_counts;for(var e=n.行,r=n.列,o=n.nets,c=(n.block2net,n.pin_counts,[]),l=0;l<o.length;l++){for(var s=o[l],u=[],h=[],i=0;i<s.length;i++){var p=s[i],v=t[p],f=v%r,_=parseInt(v/r)%e;u.push(f),h.push(_)}var g=Math.max.apply(Math,u),M=Math.min.apply(Math,u),b=Math.max.apply(Math,h),d=Math.min.apply(Math,h),k=g-M+(b-d)*a;c.push(k)}return c},initialize_placement:function(t){for(var n=t.block_counts,a=(t.net_counts,t.行),e=t.列,r=(t.nets,t.block2net,t.pin_counts,[]),o=0;o<a*e;o++)r.push(o);for(var c=0;c<a*e;c++){var l=Math.floor(a*e*Math.random()),s=Math.floor(a*e*Math.random()),u=r[l];r[l]=r[s],r[s]=u}for(var h=r.slice(0,n),i=[],p=0;p<a*e;p++)i.push(-1);for(var v=0;v<h.length;v++)i[h[v]]=v;return{"布局":h,"反布局":i}},swap_cell:function(t,n,a,e){var r=t[a],o=n[e];t[a]=e,-1!=o?(t[o]=r,n[r]=o):n[r]=-1;n[e]=a},swap_cell_v2:function(t,n,a,e,r,o,c,l){void 0===l&&(l=2);var s=n.布局[o],u=n.反布局[c];a.布局[o]=c,-1!=u&&(a.布局[u]=s);a.反布局[c]=o,a.反布局[s]=u;for(var h=new Set,i=0;i<t.block2net.get(o).length;i++)h.add(t.block2net.get(o)[i]);if(-1!=u)for(var p=0;p<t.block2net.get(u).length;p++)h.add(t.block2net.get(u)[p]);var v=t["列"],f=t["行"];h.forEach((function(n,e){var o,c,s,u,h,i,p=e;o=-1,s=-1,c=v,u=f;for(var _=0;_<t.nets[p].length;_++){var g=a.布局[t.nets[p][_]];(h=g%v)<c&&(c=h),h>o&&(o=h),(i=parseInt(g/v)%f)<u&&(u=i),i>s&&(s=i)}r[p]=l*(s-u)+(o-c)}))}}),n._RF.push({},"0e9bdDi/6JCSrDj+j58SaDo","Placer",void 0),n._RF.pop()}}}));

System.register("chunks:///_virtual/Solver.ts",["cc","./Placer.ts","./common.ts"],(function(t){"use strict";var i,s,e,n,o,h,c,a;return{setters:[function(t){i=t.cclegacy},function(t){s=t.absolute_cost,e=t.swap_cell,n=t.swap_cell_v2},function(t){o=t.sum_arr,h=t.randInt,c=t.syncArr,a=t.syncMap}],execute:function(){var _;i._RF.push({},"d733doep6hOwL3es0+YCvAn","Solver",void 0),function(t){t[t.START=0]="START",t[t.ANNEALING=1]="ANNEALING",t[t.STOP=2]="STOP"}(_||(_={}));t("Solver",function(){function t(){this.state=void 0,this.startT=void 0,this.betaDecay=void 0,this.stopCount=void 0,this.windowProportion=void 0,this.cosineAnnealPeriod=void 0,this.KFactor=void 0,this.window=void 0,this.max_window=void 0,this.min_window=void 0,this.prev_cost=void 0,this.T=void 0,this.不动次=void 0,this.次=void 0,this.K_NUM=void 0,this.上cost=void 0,this.周期现在=void 0,this.cost_per_net=void 0,this.cost_per_net_cache=void 0,this.placement=void 0,this.placement_cache=void 0,this.netlist_info=void 0}var i=t.prototype;return i.setParameters=function(t,i,s,e,n){this.startT=t,this.betaDecay=i,this.stopCount=s,this.cosineAnnealPeriod=e,this.KFactor=n},i.setBeta=function(t){this.betaDecay=t},i.setStartT=function(t){this.startT=t},i.setStopCount=function(t){this.stopCount=t},i.setCosineAnnealPeriod=function(t){this.cosineAnnealPeriod=t},i.setKFactor=function(t){this.KFactor=t},i.setPlacement=function(t){this.placement=t,this.placement_cache=JSON.parse(JSON.stringify(t))},i.setNetlistInfo=function(t){this.netlist_info=t},i.reset=function(){this.state=_.START,this.cost_per_net=s(this.placement.布局,this.netlist_info),this.cost_per_net_cache=s(this.placement.布局,this.netlist_info),this.prev_cost=o(this.cost_per_net),this.T=this.startT,this.不动次=0,this.次=0,this.上cost=0,this.T_amp=this.T;var t=this.netlist_info["列"],i=this.netlist_info["行"];this.window=[t,i],this.max_window=[t,i],this.min_window=[2,2],this.周期现在=0,this.cosineAnnealPeriod%2==1&&(this.cosineAnnealPeriod+=1)},i.swapOnce=function(){this.state=_.ANNEALING;var t=h(0,this.netlist_info.block_counts),i=this.placement["布局"][t],n=this.netlist_info["列"],c=this.netlist_info["行"],a=i%n,r=parseInt(i/n)%c,p=(h(a-parseInt(this.window[0])/2,a+parseInt(this.window[0])/2)%n+h(r-parseInt(this.window[1])/2,r+parseInt(this.window[1])/2)%c*n)%(n*c);p=p<0?p+n*c:p,console.log(this.placement.布局),console.log(t,p),e(this.placement.布局,this.placement.反布局,t,p),console.log(this.placement.布局),this.cost_per_net=s(this.placement.布局,this.netlist_info),this.prev_cost=o(this.cost_per_net)},i.swapRound=function(){for(var t=0,i=0,s=this.KFactor*Math.pow(this.netlist_info.block_counts,4/3);t<s;){var e=h(0,this.netlist_info.block_counts),_=this.placement["布局"][e],r=this.netlist_info["列"],p=this.netlist_info["行"],l=_%r,d=parseInt(_/r)%p,w=(h(l-parseInt(this.window[0]/2),l+parseInt(this.window[0]/2))%r+h(d-parseInt(this.window[1]/2),d+parseInt(this.window[1]/2))%p*r)%(r*p);w=w<0?w+r*p:w,n(this.netlist_info,this.placement,this.placement_cache,this.cost_per_net,this.cost_per_net_cache,e,w);var m=o(this.cost_per_net_cache),v=m-this.prev_cost,f=0;if(v<=0)f=1;else{var u=Math.pow(2.71,-v/this.T);f=Math.random()<u?1:0}1==f?(this.prev_cost=m,c(this.placement_cache.布局,this.placement.布局),a(this.placement_cache.反布局,this.placement.反布局),c(this.cost_per_net_cache,this.cost_per_net),i+=1):(c(this.placement.布局,this.placement_cache.布局),a(this.placement.反布局,this.placement_cache.反布局),c(this.cost_per_net,this.cost_per_net_cache)),t+=1}this.次+=1,o(this.cost_per_net)==this.上cost?this.不动次+=1:(this.不动次=0,this.上cost=o(this.cost_per_net));var T=i/s;this.window=[Math.max(Math.min(this.max_window[0],this.window[0]*(.56+T)),this.min_window[0]),Math.max(Math.min(this.max_window[1],this.window[1]*(.56+T)),this.min_window[1])],this.T=.5*this.T_amp*(1+Math.cos(this.周期现在/this.cosineAnnealPeriod*2*3.1415))+1e-16,this.周期现在+=1,this.周期现在>this.cosineAnnealPeriod&&(this.T_amp*=this.betaDecay,this.周期现在=0)},i.annealStep=function(){},t}());i._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});